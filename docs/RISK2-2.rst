==================================================================================================
RISK2-2П. Відкрита процедура в якій постачальник виступає постачальником тільки для цього Замовника по конкурентних торгах. Переможцем став постійний Постачальник (уклав більше ніж 3 контракти) Замовника, який ніколи не укладав контрактів з іншими Замовниками.
==================================================================================================

***************
Суть індикатора
***************

Індикатор свідчить про ймовірність ризику маніпуляцій в закупівлях замовником з метою укладання договорів зі "своїм" або "зручним" замовником. 

Сигналізує про тендери, в яких Переможцем став постійний Постачальник (уклав більше ніж 3 контракти) Замовника, який ніколи не укладав контрактів з іншими Замовниками.

********************************
Підстава для розробки індикатора
********************************



*********************************
Методологія та алгоритм розрахунку індикатора
*********************************

Рівень розрахунку
=================

Індикатор розраховується для відкритих процедур на рівні *лоту*.

Джерела даних для розрахунку
============================

Для розрахунку індикатора використовуються наступні джерела даних:

- API модуля тендеринга електронної системи закупівель

- Таблиця зі списком участників (постачальників) які заключали доовори тільки з одним замовником (на дату розрахунку укладено бульше трьох договорів з замовником). Відсутня практика успішних процедур з іншими замовниками. :ref:`tbl_suppliersSingleBuyer`

Типи процедур
=============

Індикатор розраховується для наступних типів процедур:

 - ``aboveThresholdUA`` - Відкриті торги
 - ``aboveThresholdEU`` - Відкриті торги з публікацією англійською мовою

Типи замовників
===============

Індикатор розраховується для замовників які в системі визначені як "А — Замовник (загальний)"  -  (``general``) та "В — Замовник (спеціальний)"  -  (``special``).

Стадії процедур
===============

Подія, що вмикає розрахунок індикатора
--------------------------------------

Подія, що вмикає розрахунок індикатора - перехід процедури у статус ``active.qualification``

Подія, що вимикає розрахунок індикатора
---------------------------------------

Розрахунок індикатора вимикається одразу після того, як замовник переводить Тендер в статус ``complete``. 

Статуси процедур
----------------

Виходячи з подій, що вмикають та вимикають розрахунок індикатора, маємо наступні умови розрахунку:

- Індикатор розраховується на наступні статуси процедур:

  - ``active.awarded``
  
  - ``active.qualification``

Частота розрахунку
==================

Індикатор розраховується при будь-якій зміні json-документу, що відповідає процедурі, якщо присутні усі умови для його розрахунку.

Поля для розрахунку
===================

Для розрахунку індикатора використовуються наступні поля з API модуля тендеринга:

- ``data.contracts.status``

- ``data.contracts.suppliers.identifier.scheme``

- ``data.contracts.suppliers.identifier.id``

- ``data.procuringEntity.identifier.id``

- ``data.procuringEntity.identifier.scheme``

- ``data.contracts.awardID``

- ``data.awards.lotID``

Для розрахунку індикатора використовуються наступні аналітичні таблиці:

- :ref:`tbl_suppliersSingleBuyer``

Формула розрахунку
==================

Якщо в json-документі, що відповідає процедурі, відсутній блок ``data.contracts``, де хоча б в одного об'єкту виконується ``data.contracts.status = 'pending'``, індикатор дорівнює ``-2``. Розрахунок завершується.

Якщо в json-документі, що відповідає процедурі, присутній блок ``data.contracts``, де хоча б в одного об'єкту виконується ``data.contracts.status = 'pending'``, переходимо на наступний крок.

Індикатор розраховується наступним чином:

1. До уваги беруться контракти, де ``data.contracts.status = 'pending'``

2. До уваги беруться замовник (конкатенація ``data.procuringEntity.identifier.scheme`` та ``data.procuringEntity.identifier.id``) та постачальник (конкатенація ``data.contracts.suppliers.identifier.scheme`` та ``data.contracts.suppliers.identifier.id``).

3. Індикатор приймає значення ``1``, якщо взята до розгляду пара "замовник-постачальник" знайдена у аналтичній таблиці :ref:`tbl_suppliersSingleBuyer``

4. Лот, на який спрацьовує індикатор, визначається зі зв'язки ``data.contracts.awardID``-``data.awards.lotID``

Фактори, що впливають на неточність розрахунку
==============================================

