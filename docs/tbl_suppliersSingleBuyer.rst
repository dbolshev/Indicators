.. _tbl_suppliersSingleBuyer:

========================
tbl_suppliersSingleBuyer
========================

************************
Суть аналітичної таблиці
************************

Дана аналітична таблиця відображає для кожного замовника *постійних* постачальників, які не постачали нікому крім даного замовника. Під постійним постачальником мається на увазі постачальник, з яким протягом останнього року було укладено більше ніж 3 контракти.

*************************
Форма аналітичної таблиці
*************************

Аналітична таблиця містить наступну інформацію:

- Ідентифікатор замовника

- Ідентифікатор постійного постачальника, що працює тільки з цим замовником

Приклад того, як може виглядати аналітична таблиця:

========== ==============
Замовник   Постачальник
---------- --------------
Замовник 1 Постачальник 1
Замовник 1 Постачальник 2
Замовник 1 Постачальник 3
Замовник 2 Постачальник 1
Замовник 2 Постачальник 2
...        ...
========== ==============

******************************
Розрахунок аналітичної таблиці
******************************

Джерела даних для розрахунку
============================

Для розрахунку аналітичної таблиці вікористовуються наступні джерела даних:

- API модуля тендеринга електронної системи закупівель

Частота розрахунку
==================

Аналітична таблиця розраховується раз на добу.

Поля для розрахунку
===================

Для розрахунку використовуються наступні поля з API модуля тендеринга:

- ``data.procuringEntity.identifier.scheme``

- ``data.procuringEntity.identifier.id``

- ``data.contracts.suppliers.identifier.id``

- ``data.contracts.suppliers.identifier.scheme``

- ``data.contracts.status``

Формула розрахунку
==================

1. Перед розрахунком аналітична таблиця очищується.

2. До уваги беруться усі контракти, у яких ``data.contracts.status = 'active'``

3. Для кожного постачальника (конкатенація ``data.contracts.suppliers.identifier.scheme`` та ``data.contracts.suppliers.identifier.id``) вираховується кількість укладених ним контрактів.

4. До уваги беруться постачальники, які уклали 3 або більше контрактів.

5. Для кожного постачальника вираховується кількість унікальних замовників (конкатенація ``data.procuringEntity.identifier.scheme`` та ``data.procuringEntity.identifier.id``), з якими він укладав контракти.

6. Якщо постачальник укладав контракти тільки з одним замовником, то дана пара "замовник-постачальник" заноситься до аналітичної таблиці.